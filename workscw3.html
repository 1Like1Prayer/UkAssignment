<!DOCTYPE html>
<html>
<head>
    <!--Bootstrap CSS-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
          integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <title> COVID-19 in the UK - UPDATES </title>
    <!--    Styles for the project-->
    <style>
        body {
            padding: 5px;
            backdrop-color: #E9F5F7;
        }

        /*style the headers */
        h1, h2 {
            font-family: georgia;
        }

        hr {
            background-color: #DBA69D
        }

        /*Style the data table*/
        #wrapper {
            width: 97%;
        }

        table {
            border: 10px solid black;
            width: 100%;
        }

        th,
        td {
            width: 300px;
            border: 10px solid black;
        }

        thead > tr {
            position: relative;
            display: block;
        }

        tbody {
            display: block;
            height: 400px;
            overflow: auto;
        }

        /* Style the input  */
        #myInput {
            padding: 20px;
            margin-top: -6px;
            border: 0;
            border-radius: 0;
            background: #f1f1f1;
        }
    </style>
</head>

<body>
<div>
    <h1>UK COVID-19 Updates</h1>
    <h2>Find information regarding COVID-19 in the UK</h2>
    <p>Before using this website, please take into account that the information you may find here is very limited as
        well as outdated.
    </p>
</div>
<!--reset button - reset the entire webpage onclick  -->
<button onClick="document.location.reload()">Reset</button>
<!--COVID ALERT-->
<div class="alert alert-light fade show">
    Please notice that when there is no information in a certain date, it will be noted in the table as N/A .
    <button class="close" data-dismiss="alert">&times;</button>
</div>
<hr>
<!--User request information regarding a whole month -->
<label> Month:
    <select name="month" size="1" id="month_c">
        <option value=12>All months</option>
        <option value=0>January</option>
        <option value=1>February</option>
        <option value=2>March</option>
        <option value=3>April</option>
        <option value=4>May</option>
        <option value=5>June</option>
        <option value=6>July</option>
        <option value=7>August</option>
        <option value=8>September</option>
        <option value=9>October</option>
        <option value=10>November</option>
        <option value=11>December</option>
    </select>
</label>


<!-- User selects type of data he/she wishes to be displayed-->
<label> What data:
    <select name="datatype" size="1" id="category">
        <option value=daily>daily data</option>
        <option value=monthly>monthly data</option>
        <option value=average>daily average</option>
    </select>
</label>
<!--<input type="submit" id="datatype" name="datatype"-->
<!--       onclick="whatData(document.getElementById('category').value, document.getElementById('month_c').value)"-->
<!--       value="Request information" style="font-family:georgia;" style="background-color:rgb(116, 30, 15);">-->

<input type="submit"
       onclick="createTableByMonth(document.getElementById('month_c').value,document.getElementById('category').value)"
       value="temp">

<!--user chooses a specific date AND if the data will be displayed before, on or after that date. (
    user radio buttons for options)-->
<!--notice the user will only be able to choose a date in the frame of the data we have in the files.-->
<label>Select specific date:</label>
<input type="date" id="date_c" name="selectdate" min="2020-01-02" max="2020-11-08">

<input type="submit" id="date_c" name="selectdate" value="Request information"
       onclick="showDate(document.getElementById('date_c').value)" , style="font-family:georgia;">

<label for="frame">Select one of the following options:</label>
<label for="yellowBank">The chosen date</label>
<input type="radio" name="frame" id="onDate" value="onDate">
<label for="beforeDate">Up until the chosen date</label>
<input type="radio" name="frame" id="beforeDate" value="beforeDate">
<label for="afterDate">After the chosen date</label>
<input type="radio" name="frame" id="afterDate" value="afterDate">
<a href="javascript:dateFrame();">show frame</a>


<!-- Displaying the information that the user requested in an appropriate table-->
<form action="/displayIntel" method="get">
    <hr style="background-color:#DBA69D;">
    <style>
        table, th, td {
            border-spacing: 5px;
            border: 1px rgb(191, 230, 235);
            text-align: center;
            padding: 20px
        }
    </style>


    <!--  <input type="text" id="datatable" onkeyup="searchTable()" placeholder="Search for names.." title="Insert "> -->
    <div id="wrapper" class="container">
        <h2>Filterable Table</h2>
        <p>Type something in the input field to search the table for first names, last names or emails:</p>
        <input class="form-control" id="myinout" type="text" placeholder="Search..">
        <br>
        <thead>
        <tr>
            <th>Date</th>
            <th>Cases</th>
            <th>Test</th>
            <th>Test Capacity</th>
            <th>Patients in Hospital</th>
        </tr>
        </thead>
        <tbody id="datatable">
        <!--what works for displaying the table with the push of a button:-->
        <table class="table table-bordered">
            <button type="button" onclick="load()">Get covid information</button>
            <br><br>
            <!--actually works! generate table without changes-->

            <button type="button" onclick="loadXMLFile('12')">Get covid information</button>
            <br><br>
            <table id="datatable"></table>
    </div>

    <!--show top 10 outputs in table-->

    <!--<button type="button" onclick="loadXMLFileTop('12')">Get top 10 outputs</button>
    <br><br>
    <table id="datatable"></table>
    </div> -->


    <!--Alert- resources for accurate and updated COVID-19 information-->
    <div class="alert alert-info alert alert-success" role="alert">
        <h4 class="alert-heading">Disclaimer:</h4>
        <hr>
        <p class="mb-2">Please note that this webpage displays very limited data and statistics regarding the state of
            the pandemic in the UK.</p>
        <p class="mb-2">For updated information and statistics regarding COVID-19 please refer to the official websites
            of reliable organizations or governments.</p>
        <div class="alert alert-dark alert-dismissible fade show" role="alert">
            <a href="https://www.worldometers.info/coronavirus/" class="alert-link">world-o-meter</a> - For more
            information, updates and statistic regarding the pandemic in the world.
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="alert alert-dark alert-dismissible fade show" role="alert">
            <a href="https://www.covidlive.co.uk/" class="alert-link">CovidLiveUK</a> - For visual updates and
            statistics regarding the pandemic in the UK.
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="alert alert-dark alert-dismissible fade show" role="alert">
            <a href="https://www.gov.uk/coronavirus" class="alert-link">GOV.UK</a> - For instructions and information
            regarding the pandemic in the UK.
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>


        <script>
            //Create table with data from the files- case.xml, testing.xml, hospital.xml
            //Some code is taken from W3 tutorials.
            //Create table with data from the files- case.xml, testing.xml, hospital.xml
            // var files = ["cases.xml", "testing.xml", "hospital.xml"];
            // var count = 0;
            // table = "<tr><th>Date</th><th>Cases</th><th>Tests</th><th>Testing Capacity</th><th>Hospital Cases</th></tr>";

            // function loadXMLFile(month) {
            //     var xmlhttp = new XMLHttpRequest();
            //     xmlhttp.open("GET", files[count], true);
            //     xmlhttp.onreadystatechange = function () {
            //         if (this.readyState == 4 && this.status == 200) {
            //             createTable(this, month);
            //             count++;
            //             if (count < files.length)
            //                 loadXMLFile(month)
            //         }
            //     };
            //     xmlhttp.send();
            // }

            function createTable(xml, month) {
                var i;
                var xmlDoc = xml.responseXML;
                var x = xmlDoc.getElementsByTagName("data");
                if (count == 0) {
                    for (i = 0; i < x.length; i++) {
                        if (month == "12" || parseInt(x[i].getElementsByTagName("date")[0].childNodes[0].nodeValue.slice(5, 7)) == parseInt(month) + 1) {
                            table += "<tr><td>" +
                                x[i].getElementsByTagName("date")[0].childNodes[0].nodeValue +
                                "</td><td>";
                            table += x[i].getElementsByTagName("newCasesByPublishDate")[0].childNodes[0].nodeValue +
                                "</td><td>";
                            table += "N/A" + "</td><td>" + "N/A" + "</td><td>" + "N/A" + "</td></tr>";

                        }
                    }
                    document.getElementById("datatable").innerHTML = table;
                }
                if (count == 1) {
                    for (i = 1; i < document.getElementById("datatable").rows.length; i++) {
                        for (j = 0; j < x.length; j++) {
                            if (x[j].getElementsByTagName("date")[0].childNodes[0].nodeValue
                                == document.getElementById("datatable").rows[i].cells[0].innerHTML) {
                                if (x[j].getElementsByTagName("newPCRTestsByPublishDate")[0].childNodes[0])
                                    document.getElementById("datatable").rows[i].cells[2].innerHTML
                                        = x[j].getElementsByTagName("newPCRTestsByPublishDate")[0].childNodes[0].nodeValue;
                                if (x[j].getElementsByTagName("plannedPCRCapacityByPublishDate")[0].childNodes[0])
                                    document.getElementById("datatable").rows[i].cells[3].innerHTML
                                        = x[j].getElementsByTagName("plannedPCRCapacityByPublishDate")[0].childNodes[0].nodeValue;
                            }
                        }
                    }
                }
                if (count == 2) {
                    for (i = 1; i < document.getElementById("datatable").rows.length; i++) {
                        for (j = 0; j < x.length; j++) {
                            if (x[j].getElementsByTagName("date")[0].childNodes[0].nodeValue
                                == document.getElementById("datatable").rows[i].cells[0].innerHTML) {
                                document.getElementById("datatable").rows[i].cells[4].innerHTML
                                    = x[j].getElementsByTagName("hospitalCases")[0].childNodes[0].nodeValue;
                            }
                        }
                    }
                }

            }


            function drawTable() {
                var i;

                var tableheaders = "<tr><th>Date</th><th>Cases</th><th>Tests</th><th>Test Capacity</th><th>Patients in Hospital</th></tr>";

                for (i = 0; i < rows.length; i++) {
                    tableheaders += "<tr><td>" + rows[i].date
                        + "</td><td>" + rows[i].newCasesByPublishDate
                        + "</td><td>" + rows[i].newPCRTestsByPublishDate
                        + "</td><td>" + rows[i].plannedPCRCapacityByPublishDate
                        + "</td><td>" + rows[i].hospitalCases
                        + "</td></tr>";
                }
                console.log(rows);
                //name of table created is datatable
                document.getElementById("datatable").innerHTML = tableheaders;
            }


            //task 2 - show type of data for a specific month that the user choses from dropdown menu

            function whatData(datatype, month) {
                //alert(datatype);
                //alert("bla");


                //daily data will be marked as  0
                if (datatype == '0') {
                    loadXMLFile(month);
                    //return table without any changes/filters
                }
                //monthly total will be marked as 1
                else if (datatype == 1) {
                    //loadMonthlyXMLFile(month);
                    //monthlyData(month);
                    //return the total for each category 
                    //the name of the month should be displayed in the 'date' column

                }
                //daily average will be marked as  2
                else if (datatype == 2) {

                }

            }

            function showDate(selectdate) {

            }

            //the two following functions will be used to get the monthly total of each column in the month the user has chosen.
            /*function loadMonthlyXMLFile(month) {
                var xmlhttp = new XMLHttpRequest();
                xmlhttp.open("GET", files[count], true);
                xmlhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    monthlyData(this, month);
                    count++;
                    if (count < files.length)
                        loadMonthlyXMLFile(month)
                }
                };
                xmlhttp.send();
            }
            function monthlyData(xml, month) {
                
                var i;
                var xmlDoc = xml.responseXML;
                var x = xmlDoc.getElementsByTagName("data");
                var newcases = 0;
                if (count == 0) {
                for (i = 0; i < x.length; i++) {
                    if(month == "12" || parseInt(x[i].getElementsByTagName("date")[0].childNodes[0].nodeValue.slice(5,7))==parseInt(month)+1){
                        //total of cases
                        newcases += parseInt(x[i].getElementsByTagName("newCasesByPublishDate")[0].childNodes[0].nodeValue);
                        
                    } 
                }
                document.getElementById("datatable").innerHTML = table;
                }
                var newtests=0;
                var newtestscap=0;
                if (count == 1) {
                    for (i = 1; i < document.getElementById("datatable").rows.length; i++) {
                        for (j = 0; j < x.length; j++) {
                            if(month == "12" || parseInt(x[i].getElementsByTagName("date")[0].childNodes[0].nodeValue.slice(5,7))==parseInt(month)+1) {
                                if(x[j].getElementsByTagName("newPCRTestsByPublishDate")[0].childNodes[0]){
                                    newtests += parseInt(x[j].getElementsByTagName("newPCRTestsByPublishDate")[0].childNodes[0]);
                                }
                            
                                if(x[j].getElementsByTagName("plannedPCRCapacityByPublishDate")[0].childNodes[0]){
                                    newtestscap +=parseInt(x[j].getElementsByTagName("plannedPCRCapacityByPublishDate")[0].childNodes[0]);
                                }

        
                            }
                        } 
                        
                    }
                }
                var newpatientsinh =0;
                if (count == 2) {
                    for (i = 1; i < document.getElementById("datatable").rows.length; i++) {
                        for (j = 0; j < x.length; j++) {
                            if (month=="12" || parseInt(x[j].getElementsByTagName("date")[0].childNodes[0].nodeValue.slice(5,7))== parseInt(month)+1) {
                                    //document.getElementById("datatable").rows[i].cells[4].innerHTML
                                    newpatientsinh += parseInt(x[j].getElementsByTagName("hospitalCases")[0].childNodes[0].nodeValue);
                                }
                            }
                        }
                    }
                console.log(newcases);
                console.log(newtests);
                console.log(newtestscap);

            }*/



            //search the table:
            /*function searchTable() {
                var input, filter, table, tr, td, i, txtValue;
                input = document.getElementById("datatable");
                
                table = document.getElementById("datatable");
                tr = table.getElementsByTagName("tr");
                for (i = 0; i < tr.length; i++) {
                    td = tr[i].getElementsByTagName("td")[0];
                    if (td) {
                        txtValue = td.textContent || td.innerText;
                    if (txtValue.toUpperCase().indexOf(filter) > -1) {
                        tr[i].style.display = "";
                    } else {
                        tr[i].style.display = "none";
                    }
                    }       
                }
            }
            //drop down filter table
            /*$(document).ready(function(){
            $("#myInput").on("keyup", function() {
                var value = $(this).val().toLowerCase();
                $(".dropdown-menu li").filter(function() {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
                });
            });
            });*/
            //$('[data-command="reset"]').click(function () {    
            //window.location.href = window.location.href;
            //}
        </script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <!--        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"-->
        <!--                integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"-->
        <!--                crossorigin="anonymous"></script>-->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
                integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
                crossorigin="anonymous"></script>
        <script src="temp.js"></script>
</body>
</html>
